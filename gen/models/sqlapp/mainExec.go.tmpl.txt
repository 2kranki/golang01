// vi:nu:et:sts=4 ts=4 sw=4
// See License.txt in main repository directory

// SQL Application main program

// Generated: [[Time]]

package main

import (
    "fmt"
	"net/http"
)

func HndlrFavIcon(w http.ResponseWriter, req *http.Request) {
	http.NotFound(w, r)
}

func HndlrHome(w http.ResponseWriter, req *http.Request) {
    if r.URL.Path != "/" {
        http.NotFound(w, r)
        return
    }

    w.Write([]byte("Set up main menu here..."))
}

func exec() {

    router := mux.NewRouter()
    router.HandleFunc("/favicon.ico", FavIconHndlr).Methods("GET")
	http.HandleFunc("/", mainIndex)
	http.HandleFunc("/favicon.ico", noFile)
	[[- range $t := .Data.Tables -]]
	    http.HandleFunc("/[[$t.Name]]",                   [[$t.Name]]HndlrIndex)
	    http.HandleFunc("/[[$t.Name]]/show",              [[$t.Name]]HndlrShow)
	    http.HandleFunc("/[[$t.Name]]/create",            [[$t.Name]]HndlrCreate)
	    http.HandleFunc("/[[$t.Name]]/create/process",    [[$t.Name]]HndlrCreateProcess)
	    http.HandleFunc("/[[$t.Name]]/update",            [[$t.Name]]HndlrUpdate)
	    http.HandleFunc("/[[$t.Name]]/update/process",    [[$t.Name]]HndlrUpdateProcess)
	    http.HandleFunc("/[[$t.Name]]/delete/process",    [[$t.Name]]HndlrDeleteProcess)
	[[ end -]]
	srvrStr := fmt.Sprintf("%s:%s", http_srvr, http_port)
	http.ListenAndServe(srvrStr, nil)

}


func mainIndex(w http.ResponseWriter, r *http.Request) {
	//http.Redirect(w, r, "/$v.Name", http.StatusSeeOther)
}

// Tell Client that we don't have the requested file
func noFile(w http.ResponseWriter, r *http.Request) {
	http.Error(w, http.StatusText(http.StatusNotFound), http.StatusNotFound)
}